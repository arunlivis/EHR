var Data = require('../EHR_Json/data.json')

var id;
var user_name;
var password_1='Deemsys_inc'

module.exports={
    login : function (browser) {
        browser 
        .login(Data.user1[1].username, Data.user1[1].password)

},
'Get User Name':function(browser){
  browser
   .useCss()
   .pause(500)
   .click('a[class="firstLevel"]')
   .pause(300)
   .click('a[href="/EHR/Clinicadmin/view-patient-details-open"]')
   .waitForElementVisible('a[onclick="getPatientProfile()"]' , 60000)
   .pause(500)
   .getText('td[class="sorting_1"]' , function(result){
    id=result.value
    browser
      .click('a[onclick="postNavigateToProfile('+result.value+',1);"]')
   })
   browser
     .waitForElementVisible('#patient_first_name' , 60000)
     .pause(500)
     .getText('#usernameId' , function(result){
         user_name=result.value.substr(11)
     })
     .pause(500)
     .useCss()
        .pause(500)
          .click('a[href="/EHR/EHR/j_spring_security_logout"]')
          .waitForElementVisible('#username_id' , 60000)
          .pause(500)
     
},
'patient login':function(browser){
  console.log(user_name.length)
  console.log(user_name.substr(0,user_name.length-1))
  console.log(user_name.substr(user_name.length-1,user_name.length))
  browser
     .useCss()
     .pause(500)
     .setValue('#username_id' , user_name)
     .setValue('#password_id' , user_name)
     .pause(300)
     .click('button[class="btn btn-primary"][type="submit"]')
     .waitForElementVisible('a[class="firstLevel"][href="/EHR/Patient/patient-dashboard"]' , 60000)
     .pause(500)
         .isVisible('#myModal' , function(result){
            if(result.value==true){
               browser
                 .pause(800)
                .setValue('#password' , user_name)
                .setValue('#confirmpassword' , user_name)
                .pause(500)
                .click('button[onclick="return savepassword()"]')
                .waitForElementNotVisible('#myModal' , 60000)
                .pause(500)
            }
         })

},
'Change Password': function(browser){
   browser
      .useCss()
      .pause(1000)
      .click('a[class="hasSubMenu"][href="#"]')
      .pause(300)
      .click('a[href="/EHR/Patient-Details/changepassword"]')
      .waitForElementVisible('#oldpassword' , 60000)
      .pause(800)
      .click('button[onclick="return checkValidation();"]')
      .pause(800)
      .verify.visible('#existing_password_error')
      .verify.visible('#new_password_error')
      .verify.visible('#confirm_password_error')
      .pause(1000)

      .setValue('#oldpassword' , user_name.substr(0,user_name.length-1))
      .pause(500)
      .setValue('#oldpassword' , user_name.substr(user_name.length-1,user_name.length))
      
      .pause(800)
      .click('button[onclick="return checkValidation();"]')
      .pause(800)
      
      .setValue('#newpassword' , password_1)
      .pause(500)
      
      .setValue('#confirmpassword' , password_1)
      .pause(500)

      .click('button[onclick="return checkValidation();"]')
      .pause(2500)

},
'Change username':function(browser){
  browser
      .useCss()
      .pause(500)
      .click('a[class="hasSubMenu"][href="#"]')
      .pause(300)
      .click('a[href="/EHR/Patient/changeUsername"]')
      .waitForElementVisible('#patientUsername' , 60000)
      .pause(500)
      .click('button[onclick="return checkPatientUsername();"]')
      .pause(500)
      .verify.visible('#patientUsername_error')
      .verify.visible('#patientConfirmUsername_error')
      .pause(800)
      .clearValue('#patientUsername')
      .setValue('#patientUsername' , password_1)
      .pause(800)
      .clearValue('#patientConfirmUsername')
      .setValue('#patientConfirmUsername' , password_1)
      .pause(800)
      .click('button[onclick="return checkPatientUsername();"]')
},
'login with old username & password':function(browser){     
   browser
      .useCss() 
      .waitForElementVisible('#username_id' , 60000)
      .pause(500)
      .setValue('#username_id' , user_name)
      .setValue('#password_id' , user_name)
      .pause(500)
      .click('button[class="btn btn-primary"][type="submit"]')
      .pause(1000)
      
},
'Login with new username & password':function(browser){
  browser
      .pause(800)
      .clearValue('#username_id')
      .setValue('#username_id' , password_1)
      .pause(500)
      .clearValue('#password_id')
      .setValue('#password_id' , password_1)
      .pause(500)
      .click('button[class="btn btn-primary"][type="submit"]')
      .waitForElementVisible('a[class="firstLevel"][href="/EHR/Patient/patient-dashboard"]' , 60000)
      .pause(500)
},
'Reset Password': function(browser){
   browser
      .useCss()
      .pause(1000)
      .click('a[class="hasSubMenu"][href="#"]')
      .pause(300)
      .click('a[href="/EHR/Patient-Details/changepassword"]')
      .waitForElementVisible('#oldpassword' , 60000)
      .pause(800)
      
      .setValue('#oldpassword' , password_1)
      .pause(800)
      .click('button[onclick="return checkValidation();"]')
      .pause(800)
      .setValue('#newpassword' , user_name)
      .pause(500)
      .setValue('#confirmpassword' , user_name)
      .pause(500)
      .click('button[onclick="return checkValidation();"]')
      .pause(2000)

},
'Reset username':function(browser){
  browser
      .useCss()
      .pause(500)
      .click('a[class="hasSubMenu"][href="#"]')
      .pause(300)
      .click('a[href="/EHR/Patient/changeUsername"]')
      .waitForElementVisible('#patientUsername' , 60000)
      .pause(500)
      
      .clearValue('#patientUsername')
      .setValue('#patientUsername' , user_name)
      .pause(500)
      .clearValue('#patientConfirmUsername')
      .setValue('#patientConfirmUsername' , user_name)
      .pause(500)
      .click('button[onclick="return checkPatientUsername();"]')
},
'login with default username & password':function(browser){  
   browser
      .useCss()   
      .waitForElementVisible('#username_id' , 60000)
      .pause(800)
      .setValue('#username_id' , user_name)
      .pause(500)
      .setValue('#password_id' , user_name)
      .pause(500)
      .click('button[class="btn btn-primary"][type="submit"]')
      .waitForElementVisible('a[class="firstLevel"][href="/EHR/Patient/patient-dashboard"]' , 60000)
      .pause(500)
      .end()
}
}
var Data = require('../EHR_Json/data.json')

var check=[];                var employer=[];            var employer_1=[];
var type_of_insurance=[];
var check_1=[];              var insurance=[];          var insurance_1=[];
var ph_1=[];                 var phone=[];             var phone_1=[];
var policy=[];                                       var policy_1=[];
var group=[];                                          var group_1=[];
var hear=[];          var sub=[];
var pho=[];          var pho_4=[];

var id;
var user_name;

module.exports={
    login : function (browser) {
        browser 
        .login(Data.user1[1].username, Data.user1[1].password)

},
'Get User Name':function(browser){
	browser
	 .useCss()
	 .pause(500)
	 .click('a[class="firstLevel"]')
	 .pause(300)
	 .click('a[href="/EHR/Clinicadmin/view-patient-details-open"]')
	 .waitForElementVisible('a[onclick="getPatientProfile()"]' , 60000)
	 .pause(500)
	 .getText('td[class="sorting_1"]' , function(result){
	 	id=result.value
	 	browser
	 	  .click('a[onclick="postNavigateToProfile('+result.value+',1);"]')
	 })
	 browser
	   .waitForElementVisible('#patient_first_name' , 60000)
	   .pause(500)
	   .getText('#usernameId' , function(result){
	   	   user_name=result.value.substr(11)
	   })
	   .pause(500)
	   .click('a[onclick="getDefaultFormList();"]')
	   .waitForElementVisible('button[onclick="lockConfirmation()"]' , 60000)
	   .pause(500)
	   .useXpath()
	   .click("//*[@id='formsContent']/div/div/a[text()='Confidential Patient Information']")
	       .useCss()
       .waitForElementVisible('#cpiDate' , 60000)
       .pause(500)
       .getValue('#employername' , function(result){
                         check.push(result.value)
       })
                   
       .getValue('#insuranceType_id' , function(result){
             type_of_insurance.push(result.value)
       })
       .getValue('#healthInsuranceName_id' , function(result){
             check_1.push(result.value)
       })
       .getValue('#healthInsurancePhone_id' , function(result){
            if(result.value==""){
              ph_1.push(0)
            }else{
              abc=result.value
             ph_1.push(abc[1]+abc[2]+abc[3]+abc[6]+abc[7]+abc[8]+abc[10]+abc[11]+abc[12]+abc[13])
           }
       })
       .pause(500)
       .click('a[href="/EHR/EHR/j_spring_security_logout"]')
     .waitForElementVisible('#username_id' , 60000)
     .pause(500)
},
'patient login':function(browser){
	browser
	   .useCss()
	   .pause(500)
	   .setValue('#username_id' , user_name)
	   .setValue('#password_id' , user_name)
	   .pause(300)
	   .click('button[class="btn btn-primary"][type="submit"]')
	   .waitForElementVisible('a[class="firstLevel"][href="/EHR/Patient/patient-dashboard"]' , 60000)
	   .pause(500)
	       .isVisible('#myModal' , function(result){
	  	      if(result.value==true){
	  	   	     browser
	  	   	      .setValue('#password' , user_name)
	  	   	      .setValue('#confirmpassword' , user_name)
	  	   	      .pause(500)
	  	   	      .click('button[onclick="return savepassword()"]')
	  	   	      .waitForElementNotVisible('#myModal' , 60000)
	  	   	      .pause(500)
	  	      }
	       })

},
'Profile':function(browser){
	browser
	  .useCss()
	  .pause(500)
	  .waitForElementVisible('a[href="/EHR/Patient-Details/profile"]' , 60000)
	  .click('a[href="/EHR/Patient-Details/profile"]')
	  .waitForElementVisible('#patient_first_name' , 60000)
	  .pause(500)
},
'Health Insurance Information':function(browser){
    browser
	   .click('a[onclick="getDefaultFormList();"]')
	   .useXpath()
	   .waitForElementVisible("//*[@id='formsContent']/div/div/a[text()='Health Insurance Information']" , 60000)
	   .pause(500)
	   .click("//*[@id='formsContent']/div/div/a[text()='Health Insurance Information']")
},
'Fill Form':function(browser){
    browser	   
	   .useCss()
	   .waitForElementVisible('#Date' , 60000, function(result){
		browser
		.pause(500)
		.getValue('#employersName' , function(result){
	            	employer.push(result.value)
	    })
	            if([type_of_insurance.map(Number)]!='0' && [type_of_insurance.map(Number)]!='4' || [ph_1.map(Number)]!='0' ||[check_1.map(Number)]!='0'){
	            	   
	            	   browser
	            	    .useCss()
	            	    .getAttribute('#haveHealthInsuranceYes' , 'checked' , function(result){
	            	    	browser
	            	    	.pause(500)
	            	    	.verify.elementPresent('[id="haveHealthInsuranceYes"][checked="checked"]')
	            	    	
	            	    	.getValue('#insuranceCompany' , function(result){
	            	    		insurance.push(result.value)
	            	    	})
	            	    	.getValue('#phone' , function(result){
	            	    		ibm=result.value
	            	    		phone.push(ibm[1]+ibm[2]+ibm[3]+ibm[6]+ibm[7]+ibm[8]+ibm[10]+ibm[11]+ibm[12]+ibm[13])
	            	    		
	            	    	})
	            	    	      a1=Math.floor((Math.random()*1000000000)+9000000000)
                                  a2=Math.floor((Math.random()*1000000000)+9000000000)
                                  policy.push(a1)
                                  group.push(a2)
                                     browser
                                           .useCss()
                                           .clearValue('#policy')
                                           .setValue('#policy' , policy)
                                           .clearValue('#group')
                                           .setValue('#group' , group)
                                           
	            	    })
	            }else{
	            	              policy.push(0)
                                  group.push(0)
	            	 browser
	            	    .useCss()
	            	    .getAttribute('#haveHealthInsuranceNo' , 'checked' , function(result){
	            	    	browser
	            	    	.pause(500)
	            	    	.verify.elementPresent('[id="haveHealthInsuranceNo"][checked="checked"]')
	            	    	.verify.elementPresent('[id="insuranceCompany"][disabled="disabled"]')
	            	    	.verify.elementPresent('[id="phone"][disabled="disabled"]')
	            	    	.verify.elementPresent('[id="policy"][disabled="disabled"]')
	            	    	.verify.elementPresent('[id="group"][disabled="disabled"]')
	            	    })
	            }
    })
                                  www=['Allstate' , 'General Re' , 'QBE' , 'Protective Life']
                                  a3=www[Math.floor(Math.random()*www.length)]
                                  a4=Math.floor((Math.random()*1000000000)+9000000000)
                                  hear.push(a3)
                                  pho.push(a4)
                                      browser
                                           .useCss()
                                           .clearValue('#supplementalInsuranceCompany')
                                           .setValue('#supplementalInsuranceCompany' , hear)
                                           .clearValue('#supplementalPhone')
                                           .setValue('#supplementalPhone' , pho)
                                           .pause(500)
                                           .getLocationInView('button[class="btn btn-primary requestRecHidden uncompletedVisible"][type="submit"]')
                                           .pause(500)
                                           .getLocationInView('#supplementalPhone')
                                           .pause(500)
                                           .click('#acceptstatement_id')
                                           .pause(500)
                                           .getLocationInView('button[class="btn btn-primary requestRecHidden uncompletedVisible"][type="submit"]')
                                           .pause(500)
                                           .getLocationInView('#patientSignatureDate')
                                           .pause(500)
                                           .click('button[class="btn btn-primary requestRecHidden uncompletedVisible"][type="submit"]')
            .waitForElementVisible('a[onclick="getDefaultFormList();"]' , 60000)
	        .pause(500)
	        .useXpath()
            .pause(500)
            .verify.elementNotPresent("//*[@id='formsContent']/div/div/a[text()='Health Insurance Information']")
            .pause(500)
            .useCss()
            .click('a[href="/EHR/EHR/j_spring_security_logout"]')
            .waitForElementVisible('#username_id' , 60000)
            .pause(500)
},
'Admin login':function(browser){
	browser
	   .useCss()
	   .pause(500)
	   .setValue('#username_id' , Data.user1[1].username)
	   .setValue('#password_id' , Data.user1[1].password)
	   .pause(300)
	   .click('button[class="btn btn-primary"][type="submit"]')
	   .waitForElementVisible('a[class=""]' , 60000)
	   .pause(500)
	   .click('a[class="firstLevel"]')
	   .pause(300)
	   .click('a[href="/EHR/Clinicadmin/view-patient-details-open"]')
	   .waitForElementVisible('a[onclick="getPatientProfile()"]' , 60000)
	   .pause(500)
	   .click('a[onclick="postNavigateToProfile('+id+',1);"]')
	   .waitForElementVisible('#patient_first_name' , 60000)
	   .pause(500)
	   .click('a[onclick="getDefaultFormList();"]')
},
'Check':function(browser){
   browser	   
	   .useXpath()
	   .waitForElementVisible("//*[@id='formsContent']/div/div/a[text()='Confidential Patient Information']" , 60000)
	   .pause(1000)
       .getLocationInView("//*[@id='formsContent']/div/div/a[text()='Health Insurance Information']")
       .pause(2500)
       .useXpath()
       .getLocationInView("//*[@id='formsContent']/div/div/a[text()='Confidential Patient Information']")
       .pause(1000)
       .click("//*[@id='formsContent']/div/div/a[text()='Health Insurance Information']")
       .useCss()
       .waitForElementVisible('#btnExportPatientForm' , 60000)
	   .pause(500)
	   .getValue('#employersName' , function(result){
	               employer_1.push(result.value)
	        })

		        if([type_of_insurance.map(Number)]!='0' && [type_of_insurance.map(Number)]!='4' || [ph_1.map(Number)]!='0' ||[check_1.map(Number)]!='0'){
	            	   
	            	   browser
	            	    .useCss()
	            	    .getAttribute('#haveHealthInsuranceYes' , 'checked' , function(result){
	            	    	browser
	            	    	.pause(500)
	            	    	.verify.elementPresent('[id="haveHealthInsuranceYes"][checked="checked"]')
	            	    	
	            	    	.getValue('#insuranceCompany' , function(result){
	            	    		insurance_1.push(result.value)
	            	    	})
	            	    	.getValue('#phone' , function(result){
	            	    		ibz=result.value
	            	    		phone_1.push(ibz[1]+ibz[2]+ibz[3]+ibz[6]+ibz[7]+ibz[8]+ibz[10]+ibz[11]+ibz[12]+ibz[13])
	            	    		
	            	    	})
	            	    	.getValue('#policy' , function(result){
	            	    		//abz=result.value
	            	    		policy_1.push(result.value)
	            	    	})
	            	    	.getValue('#group' , function(result){
	            	    		group_1.push(result.value)
	            	    	})
	            	    	      
                                           
	            	    })
	            }else{
	            	              policy_1.push(0)
                                  group_1.push(0)
	            	 browser
	            	    .useCss()
	            	    .getAttribute('#haveHealthInsuranceNo' , 'checked' , function(result){
	            	    	browser
	            	    	.pause(500)
	            	    	.verify.elementPresent('[id="haveHealthInsuranceNo"][checked="checked"]')
	            	    	.verify.elementPresent('[id="insuranceCompany"][disabled="disabled"]')
	            	    	.verify.elementPresent('[id="phone"][disabled="disabled"]')
	            	    	.verify.elementPresent('[id="policy"][disabled="disabled"]')
	            	    	.verify.elementPresent('[id="group"][disabled="disabled"]')
	            	    			phone_1.push(0)
	            	    			phone.push(0)
	            	    })
	            }
	            browser
	            .pause(500)
	            .useCss()
	            .getValue('#supplementalInsuranceCompany' , function(result){
	            	     sub.push(result.value)
	            })
	            .getValue('#supplementalPhone' , function(result){
	            	 zzz=result.value
	            	     pho_4.push(zzz[1]+zzz[2]+zzz[3]+zzz[6]+zzz[7]+zzz[8]+zzz[10]+zzz[11]+zzz[12]+zzz[13])
	            })
},
'Result':function(browser){
  browser
  .useCss()
  .pause(500)
   .verify.valueContains('#employersName' , check)
	   .getAttribute('#haveHealthInsuranceYes' , 'checked' , function(result){
	   	   if(result.value=="true"){
                 browser
                   .verify.valueContains('#insuranceCompany' , check_1)
                   .verify.valueContains('#phone' , '('+ph_1.toString().substring(0, 3)+') '+ph_1.toString().substring(3, 6)+'-'+ph_1.toString().substring(6, 10))
                   .verify.valueContains('#policy' , policy)
                   .verify.valueContains('#group' , group)
	   	   }
	   })
	browser
	.verify.valueContains('#supplementalInsuranceCompany' , hear)
	.verify.valueContains('#supplementalPhone' , '('+pho.toString().substring(0, 3)+') '+pho.toString().substring(3, 6)+'-'+pho.toString().substring(6, 10))
    .pause(500)
    .end()
}      
}       
var Data = require('../EHR_Json/data.json')

var id;
var user_name;
var emailid;
var clinic_name;

module.exports={
    login : function (browser) {
        browser 
        .login(Data.user1[1].username, Data.user1[1].password)

},
'Get Clinic Name':function(browser){
  browser
     .useCss()
     .click('a[class=""][href="#"]')
     .pause(300)
     .click('a[href="/EHR/Clinicadmin/clinicadmin-profile"]')
     .waitForElementVisible('button[onclick="changeUsername()"]' , 60000)
     .pause(500)
     .getValue('#clinicname_id' , function(result){
          clinic_name=result.value
     })
     .pause(500)
},
'Get User Name':function(browser){
  browser
   .useCss()
   .pause(500)
   .click('a[class="firstLevel"]')
   .pause(300)
   .click('a[href="/EHR/Clinicadmin/view-patient-details-open"]')
   .waitForElementVisible('a[onclick="getPatientProfile()"]' , 60000)
   .pause(500)
   .getText('td[class="sorting_1"]' , function(result){
    id=result.value
    browser
      .click('a[onclick="postNavigateToProfile('+result.value+',1);"]')
   })
   browser
     .waitForElementVisible('#patient_first_name' , 60000)
     .pause(500)
     .getText('#usernameId' , function(result){
         user_name=result.value.substr(11)
     })
     .getValue('#email' , function(result){
         emailid=result.value
     })
     .pause(500)
     .useCss()
        .pause(500)
          .click('a[href="/EHR/EHR/j_spring_security_logout"]')
          .waitForElementVisible('#username_id' , 60000)
          .pause(500)
     
},
'patient login':function(browser){
  browser
     .useCss()
     .pause(500)
     .setValue('#username_id' , user_name)
     .setValue('#password_id' , user_name)
     .pause(300)
     .click('button[class="btn btn-primary"][type="submit"]')
     .waitForElementVisible('a[class="firstLevel"][href="/EHR/Patient/patient-dashboard"]' , 60000)
     .pause(500)
         .isVisible('#myModal' , function(result){
            if(result.value==true){
               browser
                .setValue('#password' , user_name)
                .setValue('#confirmpassword' , user_name)
                .pause(500)
                .click('button[onclick="return savepassword()"]')
                .waitForElementNotVisible('#myModal' , 60000)
                .pause(500)
            }
         })

},
'Ask us':function(browser){
  browser
     .useCss()
     .pause(1000)
     .click('a[href="/EHR/Patient/Askus"]')
     .waitForElementVisible('#patientMail' , 60000)
     .pause(500)
     .verify.valueContains('#patientMail' , emailid)
     .verify.valueContains('#clinicName' , clinic_name)
     .pause(500)
     .click('button[class="btn btn-primary"][type="submit"]')
     .pause(500)
     .verify.visible('#subjectError')
     .verify.visible('#messageError')
         if (emailid=="") {
          a=['mail1@gmail.com' , 'mail2@gmail.com', 'mail3@gmail.com', 'mail4@gmail.com']
          mailid=a[Math.floor(Math.random()*a.length)]
          browser
            .verify.visible('#patientMailError')
            .pause(500)
            .setValue('#patientMail' , mailid)
         }
         b=['enquiry' , 'complaint']
         c=['when should i come' , 'will doctor available' , 'how long should i continue the treatment']
         subject=b[Math.floor(Math.random()*b.length)]
         message=c[Math.floor(Math.random()*c.length)]
  browser
     .pause(500)
     .setValue('#subject' , subject) 
     .setValue('#message' , message) 
     .pause(500)
     .click('button[class="btn btn-primary"][type="submit"]')
     .pause(5000)
     .end()
}
}
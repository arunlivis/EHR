var Data = require('../EHR_Json/data.json')

module.exports={
    login : function (browser) {
        browser 
        .login(Data.user1[1].username, Data.user1[1].password)

},
'view files' : function (browser){
      browser
      .pause(1000)      
       .useCss()
       .click('a[class="firstLevel"]')
       .pause(500)
       .click('a[href="/EHR/Clinicadmin/view-patient-details-open"]')
       .waitForElementVisible('#col0_filter' , 60000)
       .useXpath()
       .pause(200)
       .click("//*[@id='patient']/tbody/tr/td[6]/a/i")
       .useCss()
       .waitForElementVisible('#patient_first_name' , 60000)
       .pause(500)
     },
'Consent to Treat a Minor':function(browser){
  browser
    .useCss()
    .getAttribute('#date_of_birth' , 'value' , function(result){
          var birthdate = new Date(result.value);
          var cur = new Date();
          var diff = cur-birthdate; // This is the difference in milliseconds
          var age = Math.floor(diff/31536000000); // Divide by 1000*60*60*24*365
          if(age<18){
            browser
            .useXpath()
            .click("//*[@id='formtab']/a")
            .waitForElementVisible("//*[@id='formsContent']/div/div/a[text()='Confidential Patient Information']" , 60000) 
                browser
            .pause(500)
            .verify.elementPresent("//*[@id='formsContent']/div/div/a[text()='Consent to Treat a Minor']")
            .pause(500)
            .minor()
            
          }
          if(age>=18){
            browser
            .useXpath()
            .click("//*[@id='formtab']/a")
            .waitForElementVisible("//*[@id='formsContent']/div/div/a[text()='Confidential Patient Information']" , 60000)
            .pause(500)
            .verify.elementNotPresent("//*[@id='formsContent']/div/div/a[text()='Consent to Treat a Minor']")
              
          }
    })
    browser
       .end()
    }  
  }  
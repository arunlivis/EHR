var Data = require('../EHR_Json/data.json')
var test_o=[];
var test_1=[];

var chief_check=[];      var c_check=[];              var c_check_1=[];
var other=[];            var oth1=[];      var oth=[];
var Improved;             var Improved_1=[];
var patientNotes;        var patientNotes_1=[];


var o_data=[];           var o_data_1=[];             var o_data_12=[];
var A_data=[];           var A_data_1=[];             var A_data_12=[];
var cpt_code=[];         var cpt_code_1=[];           var cpt_code_12=[];
var Frequency;           var Frequency_1=[];

module.exports={
    login : function (browser) {
        browser 
        .login(Data.user1[1].username, Data.user1[1].password)

},
'view files' : function (browser){
      browser
       .pause(1000)      
       .useCss()
       .click('a[class="firstLevel"]')
       .pause(500)
       .click('a[href="/EHR/Clinicadmin/view-patient-details-open"]')
       .waitForElementVisible('#col0_filter' , 60000)
       .useXpath()
       .pause(200)
       .click("//*[@id='patient']/tbody/tr/td[6]/a/i")
       .useCss()
       .waitForElementVisible('#patient_first_name' , 60000)
       .pause(500)
},
'Exam form':function(browser){
  browser
      .useCss()
      .pause(500)
      .click('a[onclick="doGetTreatments();"]')
      .waitForElementVisible('button[onclick="openStartTreatment();"]' , 60000)
      .pause(500)
},
'Treatment Plan 1' : function (browser){
  browser
      .pause(2000)
      .useXpath()
      .click("//*[@id='treatmentformsContent']/div[2]/span/button")
      .useCss()
      .waitForElementVisible('button[onclick="addSoapNotes();"]' , 60000)
      .pause(500)
},
'soap notes' : function (browser){
	
  browser
        .useCss()
        .pause(1000)
        .getLocationInView('#backToTop')
        .useXpath()
        .pause(2500)
        .getLocationInView("//*[@id='treatmentformsContent']/div/a[text()='Initial Exam Screen 7 -']")
        .pause(1000)
        .click("//*[@id='treatmentformsContent']/div/a[text()='SOAP Notes -']")
        .useCss()
        .waitForElementVisible('#patient_name' , 60000)
        .pause(500)


        .soap(chief_check, other, test_o , o_data, test_1, A_data , cpt_code)
        .pause(500)
    cc=['headache_id', 'neckpain_id', 'chestpain_id', 'r_shoulderpain_id', 'l_shoulderpain_id', 'r_armpain_id', 'l_armrpain_id', 'r_elbowpain_id', 'l_elbowpain_id',
        'r_wristpain_id', 'l_wristpain_id', 'r_handpain_id','l_handpain_id', 'mbp_id', 'r_ribpain_id', 'l_ribpain_id', 'lbp_id', 'r_sipain_id', 'l_sipain_id', 
        'r_hippain_id','l_hippain_id', 'r_glutealpain_id', 'l_glutealpain_id', 'r_legpain_id','l_legpain_id', 'r_kneepain_id', 'l_kneepain_id', 'r_anklepain_id',
         'l_anklepain_id', 'r_footpain_id', 'l_footpain_id', 'other_id' ]
         for(i=0; i<15; i++){
          c=Math.floor((Math.random()*32)+0)
          chief_check.push(c)
          browser
           .click('#'+cc[c])
           if(c==31){
            ot=['hand pain' , 'toe pain' , 'foot pain' , 'jaw pain']
              browser
               .isVisible('#other_textbox_id', function(result) {
                d=ot[Math.floor(Math.random()*ot.length)]
                other.push(d)
                  browser
                   .clearValue('#other_textbox_id')
                   .setValue('#other_textbox_id' , d)
               })
           }
         }

         Improved=Math.floor((Math.random()*7)+0)
         pa=['hand pain' , 'toe pain' , 'foot pain' , 'jaw pain']
         patientNotes=pa[Math.floor(Math.random()*pa.length)]
         browser
            .pause(300)
            .click('input[name="improved"][value="'+Improved+'"]')
            .clearValue('#patientNotes')
            .setValue('#patientNotes' , patientNotes)

            .waitForElementVisible('#patient_name' , 60000 , function(result){
              for(i=0; i<7; i++){
               l1=test_o.length
               e=Math.floor((Math.random()*l1)+0)
               o_data.push(e)
               browser
                 .click('input[name="OData"][value="'+test_o[e]+'"]')
            }

            for(i=0; i<3; i++){
              l2=test_1.length
              f=Math.floor((Math.random()*l2)+0)
               A_data.push(f)
               browser
                 .click('input[name="AData"][value="'+test_1[f]+'"]')
            }
          })

      az=['97010' , '97014' , '97035' , '97110' , '97112' , '97122' , '97124' , '97140' , '97265' , '97504' , '98940' , '98941' , '98943' , '99201' ,'S9090']

      for(i=0; i<7; i++){
        g=Math.floor((Math.random()*7)+0)
        cpt_code.push(g)
        browser
          .click('input[name="cptcodes"][value="'+az[g]+'"]')
      }

      Frequency=Math.floor((Math.random()*7)+1)
      browser
        .click('input[name="frequencyOfCare"][value="'+Frequency+'"]')
        .pause(500)
        .click('button[onclick="saveSoapNotes();"]')
        .waitForElementVisible('button[onclick="addSoapNotes();"]' , 60000)
        .useCss()
        .pause(1000)
        .getLocationInView('#backToTop')
        .useXpath()
        .pause(2500)
        .getLocationInView("//*[@id='treatmentformsContent']/div/a[text()='Initial Exam Screen 7 -']")
        .pause(1000)
        .click("//*[@id='treatmentformsContent']/div/a[text()='SOAP Notes -']")
        .useCss()
        .waitForElementVisible('#patient_name' , 60000)
        .pause(500)

        
        
},
'check':function(browser){

  chief_check.sort();
var current = null;
var cnt = 0;
for (var i = 0; i < chief_check.length; i++) {
    if (chief_check[i] != current) {
        if (cnt > 0) {
           // console.log(current + ' comes --> ' + cnt + ' times<br>');
            if(cnt % 2 == 1){
      c_check_1.push(current)
    }
        }
        current = chief_check[i];
        cnt = 1;
    } else {
        cnt++;
    }
}
if (cnt > 0) {
   // console.log(current + ' comes --> ' + cnt + ' times');
    if(cnt % 2 == 1){
      c_check_1.push(current)
    }
}
//------------------------------------------------------------------------------------------------
o_data.sort();
var current = null;
var cnt = 0;
for (var i = 0; i < o_data.length; i++) {
    if (o_data[i] != current) {
        if (cnt > 0) {
           // console.log(current + ' comes --> ' + cnt + ' times<br>');
            if(cnt % 2 == 1){
      o_data_12.push(current)
    }
        }
        current = o_data[i];
        cnt = 1;
    } else {
        cnt++;
    }
}
if (cnt > 0) {
   // console.log(current + ' comes --> ' + cnt + ' times');
    if(cnt % 2 == 1){
      o_data_12.push(current)
    }
}
//------------------------------------------------------------------------------------------------
A_data.sort();
var current = null;
var cnt = 0;
for (var i = 0; i < A_data.length; i++) {
    if (A_data[i] != current) {
        if (cnt > 0) {
           // console.log(current + ' comes --> ' + cnt + ' times<br>');
            if(cnt % 2 == 1){
      A_data_12.push(current)
    }
        }
        current = A_data[i];
        cnt = 1;
    } else {
        cnt++;
    }
}
if (cnt > 0) {
   // console.log(current + ' comes --> ' + cnt + ' times');
    if(cnt % 2 == 1){
      A_data_12.push(current)
    }
}
//------------------------------------------------------------------------------------------------
cpt_code.sort();
var current = null;
var cnt = 0;
for (var i = 0; i < cpt_code.length; i++) {
    if (cpt_code[i] != current) {
        if (cnt > 0) {
           // console.log(current + ' comes --> ' + cnt + ' times<br>');
            if(cnt % 2 == 1){
      cpt_code_12.push(current)
    }
        }
        current = cpt_code[i];
        cnt = 1;
    } else {
        cnt++;
    }
}
if (cnt > 0) {
   // console.log(current + ' comes --> ' + cnt + ' times');
    if(cnt % 2 == 1){
      cpt_code_12.push(current)
    }
}
//------------------------------------------------------------------------------------------------
if(c_check_1.indexOf(31) > -1){
   oth.push(other.pop())
}
//-------------------------------------------------------------------------------------------------
browser
  .pause(500)
  .soapnotes(c_check, oth1 , Improved_1, patientNotes_1, test_o, o_data_1, test_1, A_data_1, cpt_code_1, Frequency_1,c_check_1,oth,Improved,patientNotes,test_o,
             test_1,cpt_code_12,Frequency)
  .pause(500)
  .end()
},
'result':''+function(browser){
  browser
  console.log("chief_check---->"+[JSON.stringify(c_check.sort(function(a,b){return a-b}))==JSON.stringify(c_check_1.sort(function(a,b){return a-b}))])
  console.log("other---------->"+[JSON.stringify(other.join())==JSON.stringify(other.join())])
  console.log("Improved------->"+[Improved==Improved_1])
  console.log("patientNotes--->"+[patientNotes==patientNotes_1])
  console.log("o_data--------->"+[JSON.stringify(o_data_1.sort(function(a,b){return a-b}))==JSON.stringify(o_data_12.sort(function(a,b){return a-b}))])
  console.log("A_data--------->"+[JSON.stringify(A_data_1.map(Number))==JSON.stringify(A_data_12.map(Number))])
  console.log("cpt_code------->"+[JSON.stringify(cpt_code_1.map(Number))==JSON.stringify(cpt_code_12.map(Number))])
  console.log("Frequency------>"+[Frequency==Frequency_1])
  
}
}
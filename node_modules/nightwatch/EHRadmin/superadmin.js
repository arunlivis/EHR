var Data = require(process.cwd()+'\\EHR_Json\\data.json')
var fs = require('fs');
var fileName = process.cwd()+'\\EHR_Json\\data.json';
var file = require(fileName);
var date =new Date();
var print=date.getDate()+""+(date.getMonth()+1)+""+date.getFullYear()+""+date.getHours()+""+date.getMinutes()+""+date.getSeconds();

var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
var stringLength = 5;

var randomString = Array.apply(null, new Array(stringLength)).map(function () {
    return possible[Math.floor(Math.random() * possible.length)];
}).join('');

var a;              var zz1=[];
var b;              var zz2=[];        
var c;              var zz3=[];  
var d;              
var city;           var zz5=[];        
var address;        var zz6=[];         
var doctor;         var zz7=[];         
var email;          var zz8=[];     
var username;         
var cli=[];         var zz=randomString+' '+print;  
var edi1=[];
var edi2=[];
var edi3=[];
var edi4=[];
var edi5=[];
var edi6=[];
var edi7=[];
var edi8=[];
var pass='123456';     

module.exports={
	login : function (browser) {
		browser 
		.login(Data.user1[0].username, Data.user1[0].password)

},
'Add Clinic' :function (browser){
	var e=["chennai" , "bangalore" , "delhi"]
	city=e[Math.floor(Math.random()*e.length)]
	var f=["car street" , "gandhi road" , "east lane road"]
	address=f[Math.floor(Math.random()*f.length)]
	var g=["Dr.Dravidamani" , "Dr.Nambiyappan" , "Dr.SeethaLakshmi"]
	doctor=g[Math.floor(Math.random()*g.length)]
	var h=["doctor11@gmail.com" , "doctor22@gmail.com" , "doctor33@gmail.com"]
	email=h[Math.floor(Math.random()*h.length)]
	a=Math.floor((Math.random()*1000000000)+9000000000)
	b=Math.floor((Math.random()*88889)+11111)
	c=Math.floor((Math.random()*888888889)+111111111)
	d=Math.floor((Math.random()*225)+2)
    
	 browser
	 .useXpath()
	.pause(500)
	.click("//*[@id='contactfrm']/div/div[1]/div/a")
	.useCss()
	.waitForElementVisible('#col0_filter' , 60000)
	.pause(500)
	.click('#addnew')
	.waitForElementVisible('#clinicname' , 60000)
	.pause(500)
	.useXpath()
	.click("//*[@id='country']/option[1]")
	
	.useCss()
	.pause(500)
	.click('#clinic_submit_button')
	.pause(500)
	.acceptAlert()
	.pause(500)
	.verify.visible('#clinicname_error')
	.pause(100)
	.verify.visible('#startedyear_error')
	.pause(100)
	.verify.visible('#physicianname_error')
	.pause(100)
	.verify.visible('#emailId_error')
	.pause(100)
	.verify.visible('#clinicphone_error')
	.pause(100)
	.verify.visible('#doctorphone_error')
	.pause(100)
	.verify.visible('#address_error')
	.pause(100)
	.verify.visible('#city_error')
	.pause(100)
	.verify.visible('#zipcode_error')
	.pause(200)
	.verify.visible('#state_error')
	.pause(200)
	.setValue('#clinicname' , zz)
	.click('#startedyear')
	.setValue('#physicianname' , doctor)
	.setValue('#emailId' , email)
	.setValue('#clinicphone' , a)
	.setValue('#doctorphone' , c)
	.setValue('#address' , address)
	.setValue('#city' , city)
	.setValue('#zipcode' , b)
	.useXpath()
	.click("//*[@id='country']/option["+d+"]")
	.pause(200)
	.click("//*[@id='state']/option[2]")
	.useCss()
	.pause(300)
	.clearValue('#max_devices')
	.setValue('#max_devices' , '2')
	.pause(500)
	.useCss()
	.click('#clinic_submit_button')                                           //save clinic
	.pause(500)
	.acceptAlert()
	.useCss()
	//.click("//*[@id='formsubmit']/div[4]/button[2]")                        //cancel
	.waitForElementVisible('#addnew' , 60000)
	.pause(1500)

//----------------------------------------------------------------------------------------------------------------------
       .useCss()
		.click('#addnew')
	.waitForElementVisible('#clinicname' , 65000)
	.pause(500)
	.setValue('#clinicname' , zz)
	.pause(500)
	.click('#clinic_submit_button')
	.waitForElementVisible('#clinicnameexist_error' , 60000)
	.pause(200)
	.verify.visible('#clinicnameexist_error')
	.pause(500)
	
//------------------------------------------------------------------------------------------------------------------------------

    .useXpath()
	.click("//*[@id='mainMenu']/ul/li[1]/a")
	.waitForElementVisible("//*[@id='contactfrm']/div/div[3]/div/a" , 60000)
	.pause(500)
	.click("//*[@id='contactfrm']/div/div[3]/div/a")
	.useCss()
	.waitForElementVisible('#col0_filter' , 60000)
	.pause(1000)
	.setValue('#col0_filter' , zz)
	.useXpath()
	.pause(1000)
	.getText("//*[@id='clinic']/tbody/tr/td[7]" , function(result){
		username=result.value
	})

//-------------------------------------------------------------------------------------------------------------------------------------
.useXpath()
.pause(1500)
.click("html/body/div[1]/section/section/div/div/div/div[3]/div[2]/div/table/tbody/tr[1]/td[8]/span/a[1]")
.waitForElementVisible("//*[@id='clinicname']" , 60000)	
browser
	.super(cli, zz1,zz2,zz3,zz5,zz6,zz7,zz8,zz,a,b,c,city,address,doctor,email)
   a1=Math.floor((Math.random()*1000000000)+9000000000)
	b1=Math.floor((Math.random()*88889)+11111)
	c1=Math.floor((Math.random()*888888889)+111111111)
	browser
	.pause(1500)
   .clearValue('#clinicname')
   .setValue('#clinicname' , zz+' clinic')
   .clearValue('#physicianname')
   .setValue('#physicianname' , doctor+' MBBS')
   .clearValue('#emailId')
	.setValue('#emailId' , 'test'+email)
	.clearValue('#clinicphone')
	.setValue('#clinicphone' , a1)
	.clearValue('#doctorphone')
	.setValue('#doctorphone' , c1)
	.clearValue('#address')
	.setValue('#address' , address+' test')
	.clearValue('#city')
	.setValue('#city' , city+' test')
	.clearValue('#zipcode')
	.setValue('#zipcode' , b1)
	.clearValue('#max_devices')
	.setValue('#max_devices' , '2')
	.pause(500)
	.click('#clinic_submit_button')                                           //save clinic
	//.click("//*[@id='formsubmit']/div[4]/button[2]")                            //cancel
	.pause(500)
	.acceptAlert()
	.waitForElementVisible("#col0_filter" , 60000)
		.useXpath()
	.pause(1000)
	.useXpath()
	.click("//*[@id='mainMenu']/ul/li[1]/a")
	.waitForElementVisible("//*[@id='contactfrm']/div/div[3]/div/a" , 60000)
	.pause(200)
	.click("//*[@id='contactfrm']/div/div[3]/div/a")
	.useCss()
	.waitForElementVisible('#col0_filter' , 60000)
	.pause(1000)
	.setValue('#col0_filter' , zz)
	.pause(1500)
	.useXpath()
	.acceptAlert()
	.pause(500)
.click("html/body/div[1]/section/section/div/div/div/div[3]/div[2]/div/table/tbody/tr[1]/td[8]/span/a[1]")
.waitForElementVisible("//*[@id='clinicname']" , 60000)	

    .superadmin(edi1, edi2, edi3, edi4, edi5, edi6, edi7, edi8,zz,a1,b1,c1,city,address,doctor,email)
    
},

'open user' : function (browser){
	browser
	.pause(1000)
    .useCss()
    .click('a[href="/EHR/j_spring_security_logout"]')
    
    .waitForElementVisible('#username_id' , 60000)
    .pause(500)
    .setValue('#username_id' , username)
    .setValue('#password_id' , username)
    .pause(100)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .waitForElementVisible("//*[@id='calendar']/div[1]/div[1]/div/button[2]" , 60000)
    .pause(1000)
    .click("//*[@id='mainMenu']/ul/li[8]/a")
    .useCss()
    .waitForElementVisible('#username_id' , 60000)
    .setValue('#username_id' , 'superadmin')
    .setValue('#password_id' , 'superadmin')
    .pause(100)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .waitForElementVisible("//*[@id='addnew']" , 60000)
    .pause(500)
    
},
'Lock the user':function(browser){
	browser
	.click("//*[@id='contactfrm']/div/div[3]/div/a")
	.useCss()
	.waitForElementVisible('#col0_filter' , 60000)
	.pause(1500)
	.setValue('#col0_filter' , zz)
	.pause(2000)
	.useXpath()
	.acceptAlert()
	.pause(500)
	.click("html/body/div[1]/section/section/div/div/div/div[3]/div[2]/div/table/tbody/tr[1]/td[8]/span/a[2]/i")
	.useCss()
	.waitForElementVisible('#myModalLabel1' , 60000)
	.pause(500)
	.useXpath()
	.click("//*[@id='myModal1']/div/div/div[3]/button[2]")
	.pause(500)
	.useCss()
    .click('a[href="/EHR/j_spring_security_logout"]')


},
'Login locked User':function(browser){
	browser
	.useCss()
    .waitForElementVisible('#username_id' , 60000)
    .pause(500)
    .setValue('#username_id' , username)
    .setValue('#password_id' , username)
    .pause(100)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .pause(1000)
    .useCss()
    .verify.visible("div[class='login-error-text']")

},
'Unlock the user':function(browser){
	browser
    .pause(1000)
    .setValue('#username_id' , 'superadmin')
    .setValue('#password_id' , 'superadmin')
    .pause(100)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .waitForElementVisible("//*[@id='addnew']" , 60000)
    .pause(500)
    .click("//*[@id='contactfrm']/div/div[2]/div/a")
	.useCss()
	.waitForElementVisible('#col0_filter' , 60000)
	.pause(1500)
	.setValue('#col0_filter' , zz)
	.pause(2000)
	.useXpath()
	.acceptAlert()
	.pause(500)
	.click("html/body/div[1]/section/section/div/div/div/div[3]/div[2]/div/table/tbody/tr[1]/td[8]/span/a[2]/i")
	.waitForElementVisible("//*[@id='enablemodal']/div/div/div[1]" , 60000)
	.pause(500)
	.click("//*[@id='enablemodal']/div/div/div[3]/button[2]")
	.pause(500)
},
'Change Password': function(browser){
	browser
	.useXpath()
	.click("//*[@id='mainMenu']/ul/li[1]/a")
	.waitForElementVisible("//*[@id='contactfrm']/div/div[3]/div/a" , 60000)
	.pause(200)
	.click("//*[@id='contactfrm']/div/div[3]/div/a")
	.useCss()
	.waitForElementVisible('#col0_filter' , 60000)
	.pause(1500)
	.setValue('#col0_filter' , zz)
	.pause(2000)
	.useXpath()
	.acceptAlert()
	.pause(500)
	.click("html/body/div[1]/section/section/div/div/div/div[3]/div[2]/div/table/tbody/tr[1]/td[8]/span/a[3]/i")
	.useCss()
	.waitForElementVisible('#password' , 60000)
	.setValue('#password' , pass)
	.setValue('#confirmpassword' , 'abcdef')
	.pause(200)
	.click("button[onclick='savepassword()']")
	.pause(200)
	.verify.visible('#confirmpassword_error')
	.clearValue('#confirmpassword')
	.setValue('#confirmpassword' , pass)
	.click("button[onclick='savepassword()']")
	.pause(800)
	.useCss()
    .click('a[href="/EHR/j_spring_security_logout"]')
},
'old and new password login':function(browser){
	browser
	.useCss()
    .waitForElementVisible('#username_id' , 60000)
    .pause(500)
    .setValue('#username_id' , username)
    .setValue('#password_id' , username)
    .pause(100)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .useCss()
    .waitForElementVisible('div[class="login-error-text"]' , 60000)
    .pause(500)
    .setValue('#username_id' , username)
    .setValue('#password_id' , pass)
    .pause(100)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .waitForElementVisible("//*[@id='calendar']/div[1]/div[1]/div/button[2]" , 60000)
    .pause(500)
    .click("//*[@id='mainMenu']/ul/li[8]/a")
},
'reset password':function(browser){
	browser
	.useCss()
    .waitForElementVisible('#username_id' , 60000)
    .pause(500)
    .setValue('#username_id' , 'superadmin')
    .setValue('#password_id' , 'superadmin')
    .pause(100)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .waitForElementVisible("//*[@id='addnew']" , 60000)
    .pause(500)
    .click("//*[@id='contactfrm']/div/div[3]/div/a")
	.useCss()
	.waitForElementVisible('#col0_filter' , 60000)
	.pause(1500)
	.setValue('#col0_filter' , zz)
	.pause(2000)
	.useXpath()
	.acceptAlert()
	.pause(500)
	.click("html/body/div[1]/section/section/div/div/div/div[3]/div[2]/div/table/tbody/tr[1]/td[8]/span/a[3]/i")
	.useCss()
	.waitForElementVisible('#password' , 60000)
	.setValue('#password' , username)
	.setValue('#confirmpassword' , username)
	.pause(200)
	.click("button[onclick='savepassword()']")
	.pause(200)
	.useCss()
    .click('a[href="/EHR/j_spring_security_logout"]')
},
'Login with default password' : function (browser){
	browser
	.useCss()
    .waitForElementVisible('#username_id' , 60000)
    .pause(500)
    .setValue('#username_id' , username)
    .setValue('#password_id' , username)
    .pause(500)
    .useXpath()
    .click("//*[@id='loginFormId']/div/button")
    .waitForElementVisible("//*[@id='calendar']/div[1]/div[1]/div/button[2]" , 60000)
    .pause(500)
},
'Edit JSON':function(browser){
	file.user1[1].username = username;
file.user1[1].password = username;

fs.writeFile(fileName, JSON.stringify(file), function (err) {
  if (err) return console.log(err);
  
})
browser
    .end()
},
'Result':''+function(browser){
	browser
	console.log("User name---------->"+username)
    console.log("Phone number------->"+[a==zz1])
    console.log("zipcode------------>"+[b==zz2])
    console.log("EIN---------------->"+[c==zz3])
    console.log("City--------------->"+[JSON.stringify(city)==JSON.stringify(zz5.join())])
    console.log("address------------>"+[JSON.stringify(address)==JSON.stringify(zz6.join())])
    console.log("doctor name-------->"+[JSON.stringify(doctor)==JSON.stringify(zz7.join())])
    console.log("email ID----------->"+[JSON.stringify(email)==JSON.stringify(zz8.join())])
    console.log("Clinic Name-------->"+[JSON.stringify(cli.join())==JSON.stringify(zz)])
    console.log("Edi Phone number--->"+[a1==edi2])
    console.log("Edi zipcode-------->"+[b1==edi3])
    console.log("Edi EIN------------>"+[c1==edi4])
    console.log("Edi City----------->"+[JSON.stringify(city+' test')==JSON.stringify(edi5.join())])
    console.log("Edi address-------->"+[JSON.stringify(address+' test')==JSON.stringify(edi6.join())])
    console.log("Edi doctor name---->"+[JSON.stringify(doctor+' MBBS')==JSON.stringify(edi7.join())])
    console.log("Edi email ID------->"+[JSON.stringify('test'+email)==JSON.stringify(edi8.join())])
    console.log("Edi Clinic Name---->"+[JSON.stringify(edi1.join())==JSON.stringify(zz+' clinic')])
    browser
    .end()
},
}